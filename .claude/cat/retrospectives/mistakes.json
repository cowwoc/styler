{
  "schema_version": "2.0",
  "description": "Centralized mistake log for cross-session retrospective analysis with pattern linkage",
  "documentation": {
    "purpose": "Mistakes logged here by learn-from-mistakes skill (Phase 9) for pattern identification",
    "pattern_linkage": "Each mistake links to a pattern_id in retrospectives.json for effectiveness tracking",
    "effectiveness_check": "Query mistakes WHERE pattern_id = X AND timestamp > action_item.completed_date",
    "processed_in_retrospective": "ID of retrospective that analyzed this mistake (R001, R002, etc.)",
    "data_retention": "Mistakes never deleted. Full audit trail preserved for temporal analysis."
  },
  "categories": [
    "tdd_violation",
    "detection_gap",
    "bash_error",
    "edit_failure",
    "architecture_issue",
    "protocol_violation",
    "worktree_violation",
    "merge_conflict",
    "build_failure",
    "test_failure",
    "logical_error",
    "git_operation_failure",
    "giving_up",
    "documentation_violation",
    "other"
  ],
  "prevention_types": [
    "code_fix",
    "hook",
    "validation",
    "config",
    "skill",
    "documentation"
  ],
  "mistakes": [
    {
      "id": "M001",
      "timestamp": "2025-11-05T00:00:00-05:00",
      "category": "git_operation_failure",
      "pattern_id": "PATTERN-001",
      "description": "Skill step failures not detected - git operations failing silently",
      "root_cause": "auto-learn-from-mistakes hook did not detect Skill tool failures",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/auto-learn-from-mistakes.sh",
      "pattern_keywords": [
        "skill",
        "step",
        "failure",
        "git"
      ],
      "commit": "c828001",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M002",
      "timestamp": "2025-11-06T00:00:00-05:00",
      "category": "git_operation_failure",
      "pattern_id": "PATTERN-001",
      "description": "Commit order assumptions in rebase automation - squashed wrong direction",
      "root_cause": "Assumed commit order without verification, squashed newer into older",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/skills/git-squash/SKILL.md",
      "pattern_keywords": [
        "git",
        "squash",
        "rebase",
        "order",
        "commit"
      ],
      "commit": "aa3b9b3",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M003",
      "timestamp": "2025-11-06T00:00:00-05:00",
      "category": "detection_gap",
      "pattern_id": "PATTERN-002",
      "description": "Missing cleanup after git operations - backup branches left behind",
      "root_cause": "No enforcement of cleanup phase after successful git operations",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/auto-learn-from-mistakes.sh",
      "pattern_keywords": [
        "cleanup",
        "backup",
        "git",
        "branch"
      ],
      "commit": "91123a7",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M004",
      "timestamp": "2025-11-07T00:00:00-05:00",
      "category": "detection_gap",
      "pattern_id": "PATTERN-002",
      "description": "Critical self-acknowledgments not detected (CRITICAL DISASTER phrases)",
      "root_cause": "Hook did not monitor for phrases indicating major problems",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/auto-learn-from-mistakes.sh",
      "pattern_keywords": [
        "critical",
        "disaster",
        "detection",
        "acknowledgment"
      ],
      "commit": "a8994b9",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M005",
      "timestamp": "2025-11-07T00:00:00-05:00",
      "category": "giving_up",
      "pattern_id": null,
      "description": "Token policy violations - assistant giving up due to token constraints",
      "root_cause": "No detection of token-related giving up patterns",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/detect-assistant-giving-up.sh",
      "pattern_keywords": [
        "token",
        "budget",
        "giving up",
        "constraint"
      ],
      "commit": "caddd58",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M006",
      "timestamp": "2025-11-11T00:00:00-05:00",
      "category": "git_operation_failure",
      "pattern_id": "PATTERN-001",
      "description": "Git squash without immediate verification - data loss risk",
      "root_cause": "Verification separated from execution, allowing errors to go unnoticed",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/skills/git-squash/SKILL.md",
      "pattern_keywords": [
        "git",
        "squash",
        "verify",
        "immediate",
        "atomic"
      ],
      "commit": "cbf0754",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M007",
      "timestamp": "2025-11-11T00:00:00-05:00",
      "category": "documentation_violation",
      "pattern_id": null,
      "description": "Execution context protections removed from optimize-doc",
      "root_cause": "Fix strategies were removed during optimization",
      "prevention_type": "config",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/commands/shrink-doc.md",
      "pattern_keywords": [
        "optimize",
        "doc",
        "context",
        "protection",
        "removal"
      ],
      "commit": "0b0a6aa",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M008",
      "timestamp": "2025-11-11T00:00:00-05:00",
      "category": "documentation_violation",
      "pattern_id": null,
      "description": "Fix strategy removal violations in documentation optimization",
      "root_cause": "Semantic content being removed instead of preserved during shrinking",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/block-retrospective-docs.sh",
      "pattern_keywords": [
        "fix",
        "strategy",
        "removal",
        "semantic",
        "preserve"
      ],
      "commit": "eedbf73",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M009",
      "timestamp": "2025-11-11T00:00:00-05:00",
      "category": "giving_up",
      "pattern_id": null,
      "description": "Option-presenting pattern instead of implementing optimal solution",
      "root_cause": "detect-giving-up hook did not catch option presentation as giving up",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/detect-giving-up.sh",
      "pattern_keywords": [
        "option",
        "present",
        "giving up",
        "implement"
      ],
      "commit": "bbe4e45",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M010",
      "timestamp": "2025-11-12T00:00:00-05:00",
      "category": "git_operation_failure",
      "pattern_id": "PATTERN-001",
      "description": "Squashing newer commit into older commit (wrong direction)",
      "root_cause": "Did not verify commit order before squashing",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/skills/git-squash/SKILL.md",
      "pattern_keywords": [
        "git",
        "squash",
        "order",
        "newer",
        "older"
      ],
      "commit": "7fee9f7",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M011",
      "timestamp": "2025-11-13T00:00:00-05:00",
      "category": "detection_gap",
      "pattern_id": "PATTERN-002",
      "description": "Ineffective fixes - prevention applied but mistake still occurred",
      "root_cause": "No temporal analysis to detect when fix predates violation",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/skills/learn-from-mistakes/SKILL.md",
      "pattern_keywords": [
        "temporal",
        "analysis",
        "ineffective",
        "fix",
        "recurrence"
      ],
      "commit": "ccf862b",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M012",
      "timestamp": "2025-11-17T00:00:00-05:00",
      "category": "protocol_violation",
      "pattern_id": null,
      "description": "Main agent creating source files in IMPLEMENTATION state",
      "root_cause": "No enforcement blocking main agent from creating .java files",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/implementation-guard.sh",
      "pattern_keywords": [
        "main",
        "agent",
        "source",
        "implementation",
        "java"
      ],
      "commit": "implementation-guard",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M013",
      "timestamp": "2025-11-17T00:00:00-05:00",
      "category": "worktree_violation",
      "pattern_id": null,
      "description": "Agent creating files in wrong worktree",
      "root_cause": "Agents not properly directed to their agent-specific worktrees",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/detect-worktree-violation.sh",
      "pattern_keywords": [
        "worktree",
        "agent",
        "directory",
        "violation"
      ],
      "commit": "detect-worktree-violation",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M014",
      "timestamp": "2025-11-17T00:00:00-05:00",
      "category": "protocol_violation",
      "pattern_id": null,
      "description": "Task tool invoked without proper state transition",
      "root_cause": "Task tool used from INIT state or without requirements reports",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/task-invoke-pre.sh",
      "pattern_keywords": [
        "task",
        "tool",
        "state",
        "init",
        "requirements"
      ],
      "commit": "task-invoke-pre",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M015",
      "timestamp": "2025-11-26T00:00:00-05:00",
      "category": "detection_gap",
      "pattern_id": "PATTERN-002",
      "description": "Destructive operations executed without confirmation",
      "root_cause": "No verification before destructive git or file operations",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/verify-destructive-operations.sh",
      "pattern_keywords": [
        "destructive",
        "verify",
        "confirmation",
        "delete"
      ],
      "commit": "verify-destructive-operations",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M016",
      "timestamp": "2025-11-26T00:00:00-05:00",
      "category": "detection_gap",
      "pattern_id": "PATTERN-002",
      "description": "Data loss from git filter-branch --all affecting version branches",
      "root_cause": "No protection for version branches during history rewriting",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/block-data-loss.sh",
      "pattern_keywords": [
        "filter-branch",
        "all",
        "version",
        "branch",
        "data loss"
      ],
      "commit": "block-data-loss",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M017",
      "timestamp": "2025-11-27T00:00:00-05:00",
      "category": "build_failure",
      "pattern_id": "PATTERN-003",
      "description": "Checkstyle violations in line length formatter implementation",
      "root_cause": "Code style rules not followed during implementation",
      "prevention_type": "validation",
      "prevention_path": "mvn checkstyle:check",
      "pattern_keywords": [
        "checkstyle",
        "style",
        "formatting",
        "violation"
      ],
      "commit": "96d878c",
      "recurrence_count": 4,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M018",
      "timestamp": "2025-11-27T00:00:00-05:00",
      "category": "build_failure",
      "pattern_id": "PATTERN-003",
      "description": "PMD violations in line length formatter implementation",
      "root_cause": "PMD rules not followed - code quality issues",
      "prevention_type": "validation",
      "prevention_path": "mvn pmd:check",
      "pattern_keywords": [
        "pmd",
        "quality",
        "violation",
        "static analysis"
      ],
      "commit": "b608714",
      "recurrence_count": 3,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M019",
      "timestamp": "2025-11-27T00:00:00-05:00",
      "category": "build_failure",
      "pattern_id": "PATTERN-003",
      "description": "Compilation errors - ContextDetector in wrong package",
      "root_cause": "Class placed in internal package but needed from public package",
      "prevention_type": "code_fix",
      "prevention_path": "src/main/java/io/github/cowwoc/styler/internal",
      "pattern_keywords": [
        "compilation",
        "package",
        "public",
        "internal",
        "access"
      ],
      "commit": "da4f33d",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M020",
      "timestamp": "2025-11-27T00:00:00-05:00",
      "category": "detection_gap",
      "pattern_id": "PATTERN-002",
      "description": "Simple mistake acknowledgments not detected by auto-learn hook",
      "root_cause": "Hook only detected complex patterns, not simple 'I made a mistake'",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/auto-learn-from-mistakes.sh",
      "pattern_keywords": [
        "acknowledgment",
        "simple",
        "detection",
        "mistake"
      ],
      "commit": "031957b",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M021",
      "timestamp": "2025-11-07T00:00:00-05:00",
      "category": "protocol_violation",
      "pattern_id": null,
      "description": "Agent role misassignment - engineer assigned for testing tasks",
      "root_cause": "Confused engineer (code quality) with tester (test strategy)",
      "prevention_type": "documentation",
      "prevention_path": "CLAUDE.md",
      "pattern_keywords": [
        "engineer",
        "tester",
        "role",
        "misassignment"
      ],
      "commit": "01acbd2",
      "recurrence_count": 0,
      "processed_in_retrospective": "R001"
    },
    {
      "id": "M022",
      "timestamp": "2026-01-02T15:52:52-05:00",
      "category": "build_failure",
      "pattern_id": null,
      "description": "Auto-detected build_failure during Bash execution",
      "root_cause": "Detected by auto-learn-from-mistakes hook. Details: BUILD FAILURE - Error compilation failed ",
      "prevention_type": "pending",
      "prevention_path": null,
      "pattern_keywords": [],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002",
      "auto_detected": true,
      "source_tool": "Bash"
    },
    {
      "id": "M023",
      "timestamp": "2026-01-02T15:52:52-05:00",
      "category": "build_failure",
      "pattern_id": null,
      "description": "Auto-detected build_failure during Bash execution",
      "root_cause": "Detected by auto-learn-from-mistakes hook. Details: üìù Logged mistake M022 (build_failure) to mistakes.json {   \\\"hookSpecificOutput\\\": {     \\\"hookEventName\\\": \\\"PostToolUse\\\",     \\\"additionalContext\\\": \\\"üìö MISTAKE DETECTED: build_failure\\n\\n**MANDATORY**: Check TodoWrite for existing entry, add if not present:\\n- content: \\\\\"LFM: Investigate build_failure from Bash\\\\\"\\n- status: \\\\\"pending\\\\\"\\n- activeForm: \\\\\"Investigating build_failure mistake\\\\\"\\n\\n**Context**: Detected build_failure during Bash execution.\\n**Details**: BUILD FAILURE - Error compilat",
      "prevention_type": "pending",
      "prevention_path": null,
      "pattern_keywords": [],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002",
      "auto_detected": true,
      "source_tool": "Bash"
    },
    {
      "id": "M024",
      "timestamp": "2026-01-02T15:53:03-05:00",
      "category": "build_failure",
      "pattern_id": null,
      "description": "Auto-detected build_failure during Bash execution",
      "root_cause": "Detected by auto-learn-from-mistakes hook. Details:   \\\"category\\\": \\\"build_failure\\\",   \\\"pattern_id\\\": null,   \\\"description\\\": \\\"Auto-detected build_failure during Bash execution\\\",   \\\"root_cause\\\": \\\"Detected by auto-learn-from-mistakes hook. Details: üìù Logged mistake M022 (build_failure) to mistakes.json {   \\\\\\\\\"hookSpecificOutput\\\\\\\\\": {     \\\\\\\\\"hookEventName\\\\\\\\\": \\\\\\\\\"PostToolUse\\\\\\\\\",     \\\\\\\\\"additionalContext\\\\\\\\\": \\\\\\\\\"üìö MISTAKE DETECTED: build_failure\\\\n\\\\n**MANDATORY**: Check TodoWrite for existing entry, add if not present:\\\\n- content: \\\\\\\\\\\\\"L",
      "prevention_type": "pending",
      "prevention_path": null,
      "pattern_keywords": [],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002",
      "auto_detected": true,
      "source_tool": "Bash"
    },
    {
      "id": "M025",
      "timestamp": "2026-01-05T14:25:00-05:00",
      "category": "git_operation_failure",
      "pattern_id": "PATTERN-006",
      "description": "Cherry-picked files from commit based on stale main, causing 60 lines of switch-parsing code to be removed",
      "root_cause": "File extraction commands (git show/checkout) return entire file content from that commit, not just changes. If source commit was based on older main, extracted files have stale base code.",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/warn-file-extraction.sh",
      "pattern_keywords": [
        "cherry-pick",
        "file extraction",
        "stale base",
        "data loss",
        "git show"
      ],
      "commit": "0e286ca",
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M026",
      "timestamp": "2026-01-05T00:00:00-05:00",
      "category": "git_operation_failure",
      "pattern_id": "PATTERN-006",
      "description": "Ran 'git reflog expire --expire=now --all && git gc --prune=now' immediately after git filter-branch, permanently destroying recovery options",
      "root_cause": "Documentation in git-rebase skill showed reflog expire and gc prune as normal cleanup step without warning about when this is dangerous. Agent followed documentation pattern without understanding implications.",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/block-reflog-destruction.sh",
      "pattern_keywords": [
        "reflog",
        "expire",
        "gc",
        "prune",
        "filter-branch",
        "recovery",
        "data loss"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M027",
      "timestamp": "2026-01-05T12:00:00-05:00",
      "category": "test_failure",
      "pattern_id": "PATTERN-005",
      "description": "Parser tests using isNotNull() on arena instead of isEqualTo(expected) - tests nothing about AST structure",
      "root_cause": "Documentation only prohibited isNotEmpty() but not isNotNull() on arena, which has the same problem of only verifying parsing succeeded",
      "prevention_type": "config",
      "prevention_path": "docs/code-style/testing-claude.md",
      "pattern_keywords": [
        "parser",
        "test",
        "isNotNull",
        "arena",
        "weak assertion",
        "AST"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M028",
      "timestamp": "2026-01-05T10:41:18-05:00",
      "category": "protocol_violation",
      "pattern_id": "PATTERN-004",
      "description": "Archival files committed as separate 4th commit instead of being included in docs commit when using code/docs/config separation pattern",
      "root_cause": "Documentation gap - no explicit guidance on archival placement in multi-commit patterns; agent added archival as new commit instead of amending existing docs commit",
      "prevention_type": "config",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/skills/git-squash/SKILL.md",
      "pattern_keywords": [
        "archival",
        "multi-commit",
        "code-docs-config",
        "squash",
        "separate-commit"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M029",
      "timestamp": "2026-01-05T15:52:14-05:00",
      "category": "logical_error",
      "pattern_id": null,
      "description": "Applied brace omission rule incorrectly - removed braces from statements spanning multiple visual lines",
      "root_cause": "Documentation used 'single-line' ambiguously without clarifying it means ONE VISUAL LINE, not just one statement. Multi-line throw statements were incorrectly treated as single-line.",
      "prevention_type": "config",
      "prevention_path": "docs/code-style/java-human.md, docs/code-style/java-claude.md, .claude/rules/java-style.md",
      "pattern_keywords": [
        "brace omission",
        "single-line",
        "multi-line",
        "visual line",
        "throw statement"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M030",
      "timestamp": "2026-01-05T15:15:33-05:00",
      "category": "build_failure",
      "pattern_id": null,
      "description": "Added @SuppressWarnings(PMD.NcssCount) to Parser.java without attempting decomposition first",
      "root_cause": "Took easy suppression path without verifying if refactoring was actually infeasible. Rationalized that shared state made extraction hard without actually attempting it.",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/warn-ncsscount-suppression.sh",
      "pattern_keywords": [
        "NcssCount",
        "PMD",
        "suppression",
        "decomposition",
        "Parser"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M031",
      "timestamp": "2026-01-06T09:54:36-05:00",
      "category": "test_failure",
      "pattern_id": "PATTERN-005",
      "description": "Manual byte offset calculation errors in parser test - wrote positions (23,46,49,55,57,58) when actual were (22,45,47,53,55,56)",
      "root_cause": "Manually calculated byte offsets in source string instead of using placeholder technique to verify positions",
      "prevention_type": "config",
      "prevention_path": "docs/code-style/testing-claude.md#verify-position-calculations",
      "pattern_keywords": [
        "parser",
        "test",
        "position",
        "byte",
        "offset",
        "manual counting"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M032",
      "timestamp": "2026-01-06T12:45:46-05:00",
      "category": "test_failure",
      "pattern_id": "PATTERN-005",
      "description": "Parser test expected values derived from actual output without verification - From actual comments prove blind copying",
      "root_cause": "Placeholder technique (write 0,0, run, update) was followed but VERIFICATION step was skipped. Comments like // From actual output: prove values were copied without verifying correctness.",
      "prevention_type": "config",
      "prevention_path": "docs/code-style/testing-claude.md#verify-position-calculations, docs/code-style/testing-claude.md#expected-value-anti-patterns",
      "pattern_keywords": [
        "parser",
        "test",
        "position",
        "verify",
        "From actual",
        "blind copy",
        "expected value"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M033",
      "timestamp": "2026-01-06T13:58:15-05:00",
      "category": "git_operation_failure",
      "pattern_id": "PATTERN-006",
      "description": "git-merge-linear-optimized.sh cleanup tried to delete branch before removing worktree",
      "root_cause": "Script executed git branch -D before git worktree remove. Git prevents deleting a branch that's checked out in an active worktree, causing error message.",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/scripts/git-merge-linear-optimized.sh",
      "pattern_keywords": [
        "worktree",
        "branch",
        "delete",
        "cleanup",
        "order",
        "git"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M034",
      "timestamp": "2026-01-08T09:00:00-05:00",
      "category": "protocol_violation",
      "pattern_id": "PATTERN-004",
      "description": "Plan deviation without informing user - Changed plan (removed --parallel flag) but didn't announce until user asked",
      "root_cause": "No mandatory checkpoint requiring announcement of plan changes before implementation. Agent proceeded with deviation silently.",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/cat/workflows/execute-phase.md#user_initiated_plan_changes",
      "pattern_keywords": [
        "plan",
        "deviation",
        "announce",
        "user",
        "change"
      ],
      "commit": "5e5c314",
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M035",
      "timestamp": "2026-01-08T09:00:00-05:00",
      "category": "protocol_violation",
      "pattern_id": "PATTERN-004",
      "description": "Merged without user review - Committed changes and marked plan complete without pausing for user review",
      "root_cause": "No mandatory user review checkpoint before committing plan implementation. Agent assumed implementation was correct.",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/cat/workflows/execute-phase.md#pre_commit_review",
      "pattern_keywords": [
        "review",
        "commit",
        "merge",
        "user",
        "approval"
      ],
      "commit": "5e5c314",
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M036",
      "timestamp": "2026-01-08T09:30:00-05:00",
      "category": "logical_error",
      "pattern_id": null,
      "description": "Misattributed change source - Claimed change was due to user feedback when actually due to discovering existing code API",
      "root_cause": "Relied on memory/summary instead of verifying actual conversation sequence via get-history. Memory was inaccurate about cause-and-effect.",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/cat/workflows/execute-phase.md#implementation_discovery_changes",
      "pattern_keywords": [
        "attribution",
        "memory",
        "sequence",
        "cause",
        "discovery"
      ],
      "commit": "2813b08",
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M037",
      "timestamp": "2026-01-08T10:00:00-05:00",
      "category": "protocol_violation",
      "pattern_id": "PATTERN-004",
      "description": "Did not invoke get-history when doing root cause analysis for learn-from-mistakes",
      "root_cause": "learn-from-mistakes skill did not require conversation verification step. Agent proceeded with analysis based on memory which was inaccurate.",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/skills/learn-from-mistakes/SKILL.md#step-0-verify-event-sequence",
      "pattern_keywords": [
        "get-history",
        "verification",
        "sequence",
        "root cause",
        "memory"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M038",
      "timestamp": "2026-01-08T10:00:00-05:00",
      "category": "protocol_violation",
      "pattern_id": "PATTERN-004",
      "description": "Did not update retrospectives/mistakes.json when learning from mistakes",
      "root_cause": "learn-from-mistakes skill did not require retrospectives logging step. Agent stated prevention but didn't log for cross-session tracking.",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/skills/learn-from-mistakes/SKILL.md#step-4-log-to-retrospectives",
      "pattern_keywords": [
        "retrospectives",
        "logging",
        "mistakes.json",
        "tracking",
        "audit"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M039",
      "timestamp": "2026-01-08T10:15:00-05:00",
      "category": "detection_gap",
      "pattern_id": null,
      "description": "False positive in Pattern 7 (git_operation_failure) when grepping JSON content from session history",
      "root_cause": "Pattern 7 matched text like 'fatal:' and 'error:' inside JSON string values when grepping session history files. No filtering for JSON content.",
      "prevention_type": "hook",
      "prevention_path": "hooks/auto-learn-from-mistakes.sh",
      "pattern_keywords": [
        "false positive",
        "JSON",
        "pattern 7",
        "grep",
        "session history"
      ],
      "commit": "da85f7c",
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M040",
      "timestamp": "2026-01-08T10:30:00-05:00",
      "category": "protocol_violation",
      "pattern_id": "PATTERN-004",
      "description": "Used relative .claude/ paths in mistakes.json instead of ${CLAUDE_PROJECT_DIR}/.claude/",
      "root_cause": "No guidance in learn-from-mistakes skill specifying that paths must use ${CLAUDE_PROJECT_DIR}. Followed existing pattern without considering working directory changes.",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/skills/learn-from-mistakes/SKILL.md#step-4-log-to-retrospectives",
      "pattern_keywords": [
        "relative path",
        "CLAUDE_PROJECT_DIR",
        "working directory",
        "prevention_path"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M041",
      "timestamp": "2026-01-08T11:00:00-05:00",
      "category": "protocol_violation",
      "pattern_id": "PATTERN-004",
      "description": "Edited plugin cache (~/.config/claude/plugins/cache/) instead of source (/workspace/claude-code-cat/)",
      "root_cause": "Skill files are invoked from cache directory. When fixing bugs, edited the deployed cache instead of the source repository. Changes would be lost on next plugin update.",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/retrospectives/mistakes.json",
      "pattern_keywords": [
        "plugin cache",
        "source directory",
        "wrong location",
        "edit"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": "R002"
    },
    {
      "id": "M042",
      "timestamp": "2026-01-08T04:30:00-05:00",
      "category": "protocol_violation",
      "pattern_id": "PATTERN-006",
      "description": "Used git rebase directly instead of git-rebase skill",
      "root_cause": "No PreToolUse hook to remind about git-rebase skill for non-interactive rebase",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/remind-git-squash-skill.sh",
      "pattern_keywords": [
        "git",
        "rebase",
        "skill",
        "backup-verify-cleanup"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": null
    },
    {
      "id": "M043",
      "timestamp": "2026-01-12T22:20:00-05:00",
      "category": "protocol_violation",
      "pattern_id": "PATTERN-004",
      "description": "Missed user squash request embedded in system-reminder during tool output",
      "root_cause": "Continued analyzing grep output instead of processing system-reminder containing user request",
      "prevention_type": "documentation",
      "prevention_path": "/workspace/CLAUDE.md",
      "pattern_keywords": [
        "system-reminder",
        "user-request",
        "mid-operation",
        "TodoWrite"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "STOP current analysis, add user request to TodoWrite, acknowledge"
    },
    {
      "id": "M044",
      "timestamp": "2026-01-12T22:30:00-05:00",
      "category": "protocol_violation",
      "pattern_id": "PATTERN-004",
      "description": "Retrospective files written to .claude/retrospectives/ instead of .claude/cat/retrospectives/",
      "root_cause": "Followed existing files at wrong location instead of skill documentation path",
      "prevention_type": "documentation",
      "prevention_path": "/workspace/cat/skills/learn-from-mistakes/SKILL.md",
      "pattern_keywords": [
        "retrospectives",
        "directory",
        "path",
        "migration"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Always use .claude/cat/retrospectives/ and migrate files if found at wrong location"
    },
    {
      "id": "M045",
      "timestamp": "2026-01-12T22:45:00-05:00",
      "category": "protocol_violation",
      "pattern_id": "PATTERN-004",
      "description": "Retrospective counter showed 1-2 when actual mistakes since last retrospective was 11",
      "root_cause": "Mistake recording and counter increment not atomic - mistakes added without incrementing counter",
      "prevention_type": "validation",
      "prevention_path": "/workspace/cat/skills/learn-from-mistakes/SKILL.md",
      "pattern_keywords": [
        "counter",
        "retrospective",
        "validation",
        "atomic"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Validate counter matches actual mistake count before incrementing, auto-fix if mismatch"
    },
    {
      "id": "M046",
      "timestamp": "2026-01-12T22:48:31-05:00",
      "category": "protocol_violation",
      "description": "Subagent added @SuppressWarnings(PMD.NcssCount) despite explicit prohibition in java-style.md. Main agent review missed the violation.",
      "root_cause": "PostToolUse hook could not actually block edits - only warned after the fact. Subagent ignored or did not see warning.",
      "prevention_type": "hook",
      "prevention_path": ".claude/hooks/block-ncsscount-suppression.sh",
      "pattern_keywords": [
        "NcssCount",
        "SuppressWarnings",
        "PMD",
        "hook",
        "PreToolUse"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Never add @SuppressWarnings(PMD.NcssCount). Instead refactor to reduce complexity."
    },
    {
      "id": "M047",
      "timestamp": "2026-01-12T23:08:40-05:00",
      "category": "protocol_violation",
      "description": "Used git merge --no-ff creating merge commit instead of ff-merge for linear history",
      "root_cause": "No enforcement blocking --no-ff flag in merge commands",
      "prevention_type": "hook",
      "prevention_path": "/workspace/cat/hooks/block-merge-commits.sh",
      "pattern_keywords": [
        "merge",
        "no-ff",
        "linear-history",
        "git"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use --ff-only for merges or /cat:git-merge-linear skill to maintain linear history"
    },
    {
      "id": "M048",
      "timestamp": "2026-01-12T23:20:19-05:00",
      "category": "protocol_violation",
      "description": "Used feature: prefix for retrospective action item implementation instead of bugfix:",
      "root_cause": "Did not recognize that action items are corrective fixes for identified problems, not new functionality",
      "prevention_type": "documentation",
      "prevention_path": "/workspace/cat/.claude/cat/references/commit-types.md",
      "pattern_keywords": [
        "commit-type",
        "feature",
        "bugfix",
        "action-item",
        "retrospective"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use bugfix: prefix for all retrospective action item implementations"
    },
    {
      "id": "M049",
      "timestamp": "2026-01-13T00:05:00-05:00",
      "category": "protocol_violation",
      "description": "Deleted .git/refs/original/ without user explicitly requesting it",
      "root_cause": "Automatically cleaned up filter-branch backup as part of 'cleanup' without asking",
      "prevention_type": "hook",
      "prevention_path": "/workspace/cat/hooks/block-reflog-destruction.sh",
      "pattern_keywords": [
        "refs/original",
        "filter-branch",
        "backup",
        "cleanup",
        "delete"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Never delete .git/refs/original unless user explicitly requests it"
    },
    {
      "id": "M050",
      "timestamp": "2026-01-13T00:20:00-05:00",
      "category": "protocol_violation",
      "description": "Used git filter-branch instead of git-filter-repo despite skill saying never use filter-branch",
      "root_cause": "No enforcement warning about deprecated filter-branch; skill guidance not checked before operation",
      "prevention_type": "hook",
      "prevention_path": "/workspace/cat/hooks/validate-git-filter-branch.sh",
      "pattern_keywords": [
        "filter-branch",
        "filter-repo",
        "deprecated",
        "history-rewrite"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use git-filter-repo with --partial flag instead of git filter-branch"
    },
    {
      "id": "M051",
      "timestamp": "2026-01-13T04:45:00Z",
      "category": "protocol_violation",
      "description": "Subagent created separate commits for test and bugfix when they should be single commit",
      "root_cause": "commit-types.md did not explicitly state that bugfix tests belong with bugfix in same commit",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/cat/.claude/cat/references/commit-types.md",
      "pattern_keywords": [
        "commit",
        "test",
        "bugfix",
        "separate",
        "squash"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "correct_behavior": "Tests for a bugfix are part of the implementation and belong in the same commit"
    },
    {
      "id": "M052",
      "timestamp": "2026-01-13T05:00:00Z",
      "category": "protocol_violation",
      "description": "Merged to main without explicit approval - interpreted feedback as approval",
      "root_cause": "User responded to approval gate with feedback about commit structure; agent incorrectly interpreted fixing the issue as implicit approval to proceed",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/cat/.claude/cat/workflows/execute-task.md",
      "pattern_keywords": [
        "approval",
        "merge",
        "permission",
        "yoloMode",
        "gate"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "correct_behavior": "After addressing approval gate feedback, re-present the approval gate and wait for explicit Approve response"
    },
    {
      "id": "M053",
      "timestamp": "2026-01-13T05:15:00Z",
      "category": "protocol_violation",
      "description": "Presented approval gate without first cleaning up subagent worktree and branch",
      "root_cause": "Workflow did not explicitly state that subagent cleanup happens BEFORE approval gate",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/cat/.claude/cat/workflows/execute-task.md",
      "pattern_keywords": [
        "subagent",
        "cleanup",
        "worktree",
        "approval",
        "gate"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "correct_behavior": "Clean up subagent worktree and branch after merging to task branch, BEFORE presenting approval gate"
    },
    {
      "id": "M054",
      "timestamp": "2026-01-13T10:30:00Z",
      "category": "tool_misuse",
      "description": "Bash script failed with 'read-only variable: status' in zsh",
      "root_cause": "Used 'status' as variable name in bash script, but zsh reserves it as read-only (contains last command exit code)",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/cat/commands/status.md",
      "pattern_keywords": [
        "bash",
        "zsh",
        "status",
        "read-only",
        "variable"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use alternative variable names like 'st', 'task_status', or 'state' instead of 'status' in bash scripts that may run under zsh"
    },
    {
      "id": "M055",
      "timestamp": "2026-01-13T05:24:26Z",
      "category": "protocol_violation",
      "description": "cat:status output missing checkbox markers for task completion status",
      "root_cause": "Did not follow skill template that clearly showed [x]/[ ] markers for every task",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/cat/commands/status.md",
      "pattern_keywords": [
        "status",
        "checkbox",
        "render",
        "output",
        "template"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Always include [x] for completed tasks and [ ] for pending tasks - template shows this explicitly",
      "superseded_by": "M056",
      "notes": "Root cause was incorrect - checkboxes WERE being output but CLI strips them"
    },
    {
      "id": "M056",
      "timestamp": "2026-01-13T16:45:00Z",
      "category": "tool_misuse",
      "description": "Claude Code CLI strips markdown checkbox syntax [x]/[ ] from list items during terminal rendering",
      "root_cause": "Markdown checkbox syntax (- [x] item) is converted to plain list (- item) by CLI renderer. M055 incorrectly assumed checkboxes weren't being output when they were being stripped post-output.",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/cat/commands/status.md",
      "pattern_keywords": [
        "status",
        "checkbox",
        "CLI",
        "rendering",
        "markdown",
        "unicode"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Remove list dash prefix - use '[x] task' instead of '- [x] task'. The dash triggers markdown list rendering which strips checkbox syntax."
    },
    {
      "id": "M057",
      "timestamp": "2026-01-13T10:15:00Z",
      "category": "protocol_violation",
      "pattern_id": null,
      "description": "Two Claude instances started working on same task - lock acquisition step skipped when SESSION_ID was not set",
      "root_cause": "Agent proceeded with task execution after SESSION_ID check showed not set, instead of stopping and requiring hook registration",
      "prevention_type": "documentation",
      "prevention_path": "/workspace/cat/commands/execute-task.md",
      "pattern_keywords": [
        "concurrent",
        "lock",
        "SESSION_ID",
        "task-lock",
        "worktree"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": null,
      "correct_behavior": "When SESSION_ID is not set, STOP execution immediately and instruct user to register echo-session-id.sh hook. Never proceed to worktree creation without acquiring task lock first.",
      "prevention_implemented": true
    },
    {
      "id": "M058",
      "timestamp": "2026-01-13T15:40:55Z",
      "category": "documentation_violation",
      "pattern_id": null,
      "description": "execute-task.md tested SESSION_ID as shell env var but hook injects to conversation context",
      "root_cause": "Design mismatch: echo-session-id.sh outputs to hookSpecificOutput.additionalContext (conversation context) but execute-task.md used ${SESSION_ID:-NOT SET} expecting shell environment variable",
      "prevention_type": "documentation",
      "prevention_path": "/workspace/cat/commands/execute-task.md",
      "pattern_keywords": [
        "SESSION_ID",
        "hook",
        "context",
        "environment",
        "execute-task"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": null,
      "correct_behavior": "Skills should instruct agents to read SESSION_ID from SessionStart system-reminder in conversation context and substitute the UUID value into bash commands, not expect it as a shell environment variable.",
      "prevention_implemented": true
    },
    {
      "id": "M059",
      "timestamp": "2026-01-13T15:53:15Z",
      "category": "protocol_violation",
      "pattern_id": null,
      "description": "Used chore: commit type instead of config: for version bumps",
      "root_cause": "Used conventional commit chore: type out of habit instead of CAT-specific config: type",
      "prevention_type": "documentation",
      "prevention_path": "/workspace/cat/.claude/cat/references/commit-types.md",
      "pattern_keywords": [
        "commit",
        "chore",
        "config",
        "version",
        "bump"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": null,
      "correct_behavior": "Use config: for version bumps, dependency changes, and tooling. chore: is NOT a valid CAT commit type.",
      "prevention_implemented": true,
      "prevention_quality": {
        "verification_type": "negative",
        "fragility": "high",
        "catches_variations": false
      },
      "notes": "Documentation-only prevention is weak (Level 6). A PreToolUse hook validating git commit message types would be Level 3 prevention with positive verification."
    },
    {
      "id": "M060",
      "timestamp": "2026-01-13T16:15:12Z",
      "category": "protocol_violation",
      "pattern_id": null,
      "description": "Manually added to mistakes.json instead of invoking /cat:learn-from-mistakes skill",
      "root_cause": "Took shortcut by directly editing mistakes.json instead of following the skill workflow which includes 5-whys analysis, prevention quality evaluation, and proper counter synchronization",
      "prevention_type": "documentation",
      "prevention_path": "/home/node/.config/claude/plugins/cache/claude-code-cat/cat/2.0.2/skills/learn-from-mistakes/SKILL.md",
      "pattern_keywords": [
        "learn-from-mistakes",
        "skill",
        "shortcut",
        "workflow"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": null,
      "correct_behavior": "Always invoke /cat:learn-from-mistakes skill when a mistake is identified. The skill workflow ensures proper analysis, prevention quality evaluation, and counter synchronization.",
      "prevention_implemented": true,
      "prevention_quality": {
        "verification_type": "negative",
        "fragility": "high",
        "catches_variations": false
      },
      "notes": "Could add a hook that detects direct edits to mistakes.json without skill invocation, but overhead may not be worth it."
    },
    {
      "id": "M061",
      "timestamp": "2026-01-13T16:18:30Z",
      "category": "protocol_violation",
      "description": "Claimed lock was '20 minutes old' when actually ~27 seconds old, and called non-existent 'task-lock.sh status' command",
      "root_cause": "Violated environment state verification rule - claimed state without measurement; assumed tool capability without verification",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/CLAUDE.md",
      "pattern_id": null,
      "pattern_keywords": [
        "environment-state",
        "verification",
        "assumption",
        "tool-misuse"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": null,
      "correct_behavior": "Always verify state claims with actual measurements (e.g., calculate lock age with date arithmetic). Check available commands before invoking (--help or read script).",
      "prevention_implemented": true,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "notes": "CLAUDE.md already has Environment State Verification rule. This was a compliance failure, not a missing rule."
    },
    {
      "id": "M062",
      "timestamp": "2026-01-13T16:26:00Z",
      "category": "context_degradation",
      "pattern_id": null,
      "description": "Subagent compaction despite task being estimated within threshold - estimation formula ignores input tokens",
      "root_cause": "Task estimation formula counts only output (files to create/modify) but ignores input context from tool calls, file reads, and test output parsing",
      "prevention_type": "config",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/cat/cat-config.json",
      "pattern_keywords": [
        "compaction",
        "estimation",
        "subagent",
        "context",
        "threshold"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use lower targetContextUsage (40% instead of 70%) to account for input tokens which are ~2x output tokens"
    },
    {
      "id": "M062",
      "timestamp": "2026-01-13T16:35:00Z",
      "category": "prompt_engineering",
      "description": "Subagent created parser tests that only check isSuccess() instead of comparing expected vs actual AST tree",
      "root_cause": "Main agent prompt provided inadequate test examples without AST verification",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/skills/spawn-subagent/SKILL.md",
      "pattern_id": null,
      "pattern_keywords": [
        "parser-tests",
        "isSuccess",
        "isEqualTo",
        "ast-verification",
        "subagent"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": null,
      "correct_behavior": "Parser tests MUST use isEqualTo(expected) pattern to verify AST structure. Main agent prompts must include explicit test examples with AST comparison.",
      "prevention_implemented": true,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "notes": "Added explicit anti-pattern section to spawn-subagent skill documenting M062."
    },
    {
      "id": "M063",
      "timestamp": "2026-01-13T17:05:00Z",
      "category": "protocol_violation",
      "description": "Main agent directly implemented test fixes instead of delegating to subagent",
      "root_cause": "Main agent violated orchestration-only role when making corrections after user feedback",
      "prevention_type": "documentation",
      "prevention_path": "/workspace/cat/.claude/cat/workflows/execute-task.md",
      "pattern_id": null,
      "pattern_keywords": [
        "main-agent",
        "orchestration",
        "subagent-delegation",
        "implementation"
      ],
      "commit": null,
      "recurrence_count": 0,
      "processed_in_retrospective": null,
      "correct_behavior": "When user provides feedback requiring code changes, delegate to a new subagent. Main agent orchestrates, subagent implements.",
      "prevention_implemented": true,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "medium",
        "catches_variations": true
      },
      "notes": "Added explicit guidance to execute-task approval gate: DELEGATE fixes to subagent, main agent does NOT implement directly."
    },
    {
      "id": "M064",
      "timestamp": "2026-01-13T17:38:58Z",
      "category": "tool_misuse",
      "description": "Used hardcoded version 2.0.2 path from stale skill template instead of current 2.0.4, and invoked nonexistent status command without checking --help",
      "root_cause": "Skill template (execute-task.md) contains hardcoded version paths that become stale when plugin is updated. Also failed to verify available commands before invocation.",
      "five_whys": [
        {
          "why": "Why use wrong version path?",
          "answer": "Skill template hardcoded /home/node/.../2.0.2/scripts/task-lock.sh"
        },
        {
          "why": "Why is path hardcoded?",
          "answer": "Template not updated when new versions released"
        },
        {
          "why": "Why invoke status command?",
          "answer": "Assumed it existed without checking --help"
        },
        {
          "why": "Why not check --help?",
          "answer": "Skipped verification step before invoking unfamiliar command"
        },
        {
          "why": "Why skip verification?",
          "answer": "Overconfidence in memory of available commands"
        }
      ],
      "prevention_type": "code",
      "prevention_path": "/workspace/cat/commands/execute-task.md",
      "pattern_keywords": [
        "version-mismatch",
        "hardcoded-path",
        "unknown-command",
        "help-verification"
      ],
      "prevention_implemented": true,
      "recurrence_count": 0,
      "processed_in_retrospective": null,
      "correct_behavior": "1) Verify script version path matches installed plugin version. 2) Run script --help to check available commands before invoking."
    },
    {
      "id": "M065",
      "timestamp": "2026-01-13T17:57:50Z",
      "category": "protocol_violation",
      "description": "Waited for another sessions task lock to become stale instead of stopping when lock was detected",
      "root_cause": "Misunderstood stale lock cleanup - it is for crashed sessions, not for waiting out active workers",
      "five_whys": [
        {
          "why": "Why did I interfere with another instance?",
          "answer": "I cleaned up their lock and acquired my own"
        },
        {
          "why": "Why did I clean up their lock?",
          "answer": "I waited until it became stale (>5 minutes)"
        },
        {
          "why": "Why did I wait for it to become stale?",
          "answer": "I thought stale meant abandoned"
        },
        {
          "why": "Why did I think it was abandoned?",
          "answer": "Misunderstood stale lock purpose - its for crashes, not timeouts"
        },
        {
          "why": "Why proceed at all when lock detected?",
          "answer": "Should have stopped immediately when another session held lock"
        }
      ],
      "prevention_type": "documentation",
      "prevention_path": "/workspace/cat/commands/execute-task.md",
      "pattern_keywords": [
        "task-lock",
        "concurrent-execution",
        "stale-lock",
        "coordination"
      ],
      "prevention_implemented": true,
      "recurrence_count": 0,
      "processed_in_retrospective": null,
      "correct_behavior": "When execute-task detects lock held by different session: 1) Report task is locked, 2) Offer to execute a DIFFERENT task, 3) NEVER wait for lock to expire or force cleanup"
    },
    {
      "id": "M066",
      "timestamp": "2026-01-13T18:30:00Z",
      "category": "protocol_violation",
      "pattern_id": null,
      "description": "Silently swallowed exception with comment \"Should never happen\" - violates fail-fast",
      "root_cause": "Assumed impossible exception does not need handling, but silent failures hide bugs",
      "prevention_type": "code_fix",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/rules/java-style.md",
      "pattern_keywords": [
        "exception",
        "swallow",
        "silent",
        "fail-fast",
        "AssertionError"
      ],
      "correct_behavior": "Always rethrow \"impossible\" exceptions as AssertionError with cause - never swallow silently",
      "recurrence_count": 0,
      "processed_in_retrospective": null
    },
    {
      "id": "M067",
      "timestamp": "2026-01-13T18:45:00Z",
      "category": "protocol_violation",
      "pattern_id": null,
      "description": "Invoked learn-from-mistakes skill but skipped workflow steps - manually added entry without proper analysis",
      "root_cause": "Treated skill invocation as a formality rather than following documented workflow",
      "prevention_type": "documentation",
      "prevention_path": "/workspace/cat/hooks/inject-session-instructions.sh",
      "pattern_keywords": [
        "skill",
        "workflow",
        "shortcut",
        "protocol"
      ],
      "correct_behavior": "When a skill is invoked, follow every step in its documented workflow completely",
      "recurrence_count": 0,
      "processed_in_retrospective": null
    },
    {
      "id": "M068",
      "timestamp": "2026-01-13T19:15:00Z",
      "category": "protocol_violation",
      "pattern_id": null,
      "description": "Used docs: commit type for Claude-facing documents instead of config:",
      "root_cause": "Did not distinguish between user-facing docs (README) and Claude-facing docs (CLAUDE.md, hooks, skills)",
      "prevention_type": "documentation",
      "prevention_path": "/workspace/cat/.claude/cat/references/commit-types.md",
      "pattern_keywords": [
        "commit",
        "type",
        "docs",
        "config",
        "claude-facing"
      ],
      "correct_behavior": "Use docs: for user-facing (README, API docs), config: for Claude-facing (CLAUDE.md, hooks, skills)",
      "recurrence_count": 0,
      "processed_in_retrospective": null
    },
    {
      "id": "M069",
      "timestamp": "2026-01-13T19:40:00Z",
      "category": "architecture_issue",
      "pattern_id": null,
      "description": "Used package-private classes in same package instead of public classes in non-exported internal package",
      "root_cause": "Followed existing ModuleParser pattern without considering module system capabilities",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/rules/java-style.md",
      "pattern_keywords": [
        "internal",
        "package-private",
        "module",
        "architecture",
        "testability"
      ],
      "correct_behavior": "Use public classes in non-exported internal package (e.g., parser.internal) for better testability and module enforcement",
      "recurrence_count": 0,
      "processed_in_retrospective": null
    },
    {
      "id": "M070",
      "timestamp": "2026-01-13T23:45:00Z",
      "category": "protocol_violation",
      "description": "Committed STATE.md update as separate planning: commit instead of including in implementation commit",
      "root_cause": "execute-task and merge-and-cleanup workflows did not specify that task STATE.md must be updated BEFORE squash/merge to be included in implementation commit",
      "prevention_type": "process",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/cat/.claude/cat/workflows/execute-task.md, ${CLAUDE_PROJECT_DIR}/cat/.claude/cat/workflows/merge-and-cleanup.md",
      "pattern_keywords": [
        "STATE.md",
        "commit",
        "squash",
        "implementation"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Update task STATE.md to completed in task branch BEFORE squashing, then amend to include in implementation commit"
    },
    {
      "id": "M071",
      "timestamp": "2026-01-13T23:55:00Z",
      "category": "protocol_violation",
      "description": "Printed retrospective trigger message without using AskUserQuestion to give user choice",
      "root_cause": "learn-from-mistakes skill step 10 did not explicitly require AskUserQuestion before triggering retrospective",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/skills/learn-from-mistakes/SKILL.md",
      "pattern_keywords": [
        "retrospective",
        "AskUserQuestion",
        "trigger",
        "prompt"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When retrospective threshold is exceeded, use AskUserQuestion with Run now/Later/Skip options"
    },
    {
      "id": "M072",
      "timestamp": "2026-01-14T00:10:00Z",
      "category": "protocol_violation",
      "description": "Presented approval gate with uncommitted changes; then fixed immediate problem instead of invoking learn-from-mistakes skill",
      "root_cause": "Workflow lacked enforceable checkpoint to verify commit before approval gate",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/cat/commands/execute-task.md",
      "pattern_keywords": [
        "approval_gate",
        "commit",
        "uncommitted"
      ],
      "prevention_implemented": true,
      "correct_behavior": "Always verify commits exist before approval gate"
    },
    {
      "id": "M073",
      "timestamp": "2026-01-14T00:15:00Z",
      "category": "protocol_violation",
      "description": "Added comments like // Position 2 = 22 in parser tests showing manual calculation",
      "root_cause": "No explicit prohibition against calculation comments in tests",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/docs/code-style/testing-claude.md",
      "pattern_keywords": [
        "parser",
        "test",
        "comment",
        "position",
        "calculation"
      ],
      "prevention_implemented": true,
      "correct_behavior": "No comments explaining position calculations - either verify programmatically or trust the test"
    },
    {
      "id": "M074",
      "timestamp": "2026-01-14T00:00:00Z",
      "category": "protocol_violation",
      "pattern_id": null,
      "description": "Investigated in-progress task instead of immediately skipping to next pending task",
      "root_cause": "Did not treat in-progress status as skip signal - read STATE.md, PLAN.md, checked commits, ran tests",
      "prevention_type": "documentation",
      "prevention_path": "/home/node/.config/claude/plugins/cache/claude-code-cat/cat/2.0.5/.claude/cat/skills/execute-task/SKILL.md",
      "pattern_keywords": [
        "in-progress",
        "skip",
        "locked",
        "next-task"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "correct_behavior": "When task status is in-progress or locked, immediately skip to find next pending task without reading details"
    },
    {
      "id": "M075",
      "timestamp": "2026-01-14T00:05:00Z",
      "category": "protocol_violation",
      "pattern_id": null,
      "description": "Did not invoke learn-from-mistakes skill when user said Learn from mistakes - dismissed with I already recorded this",
      "root_cause": "Treated Learn from mistakes as conceptual instruction rather than skill invocation trigger",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/skills/learn-from-mistakes/SKILL.md",
      "pattern_keywords": [
        "learn-from-mistakes",
        "skill",
        "invoke",
        "trigger"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "correct_behavior": "When user says Learn from mistakes, ALWAYS invoke the skill - it is a trigger phrase, not a conceptual instruction"
    },
    {
      "id": "M076",
      "timestamp": "2026-01-14T00:54:33Z",
      "category": "protocol_violation",
      "description": "STATE.md committed separately from implementation instead of in same commit",
      "root_cause": "execute-task.md workflow committed STATE.md as separate docs commit after merge instead of with implementation",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/commands/execute-task.md",
      "pattern_keywords": [
        "STATE.md",
        "commit",
        "implementation",
        "atomic"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Update and commit task STATE.md in the same commit as the implementation code, not as a separate docs commit"
    },
    {
      "id": "M077",
      "timestamp": "2026-01-14T01:15:00Z",
      "category": "prompt_engineering",
      "description": "Subagent prompt omitted STATE.md update instructions - M076 specifies STATE.md must be in same commit as implementation",
      "root_cause": "spawn-subagent skill lacks mandatory section for task STATE.md updates; main agent constructed prompt without including STATE.md",
      "prevention_type": "hook",
      "prevention_path": "/workspace/cat/hooks/verify-state-in-commit.sh",
      "pattern_keywords": [
        "STATE.md",
        "subagent",
        "prompt",
        "implementation",
        "atomic"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Subagent prompts MUST include: Update STATE.md to status: completed in the SAME commit as implementation. Hook enforces this at commit time."
    },
    {
      "id": "M078",
      "timestamp": "2026-01-13T22:18:56-05:00",
      "category": "bash_error",
      "pattern_id": null,
      "description": "Used read-only variable name status in zsh shell command",
      "root_cause": "In zsh, status is a read-only special variable containing exit status array. Using status=$(cmd) fails.",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/CLAUDE.md",
      "pattern_keywords": [
        "zsh",
        "read-only",
        "status",
        "variable",
        "bash"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use alternative variable names like st, task_status, or result instead of status in shell commands",
      "processed_in_retrospective": null
    },
    {
      "id": "M079",
      "timestamp": "2026-01-14T22:55:00Z",
      "category": "prompt_engineering",
      "description": "Subagent prompt did not prohibit expected value derivation comments in parser tests",
      "root_cause": "spawn-subagent skill lacked explicit prohibition of test derivation comments",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/skills/spawn-subagent/SKILL.md",
      "pattern_keywords": [
        "subagent",
        "parser-test",
        "comments",
        "derivation"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Subagent prompts for parser tests must include: STYLE: Do NOT add comments that describe expected node positions. Text blocks are self-documenting.",
      "processed_in_retrospective": null
    },
    {
      "id": "M080",
      "timestamp": "2026-01-14T04:35:00Z",
      "category": "protocol_violation",
      "description": "Subagent prompt for parser test did not include M079 instruction prohibiting derivation comments",
      "root_cause": "Main agent did not review existing learnings before spawning subagent for parser test task",
      "prevention_type": "process",
      "prevention_path": "N/A - recurrence of M079, no new prevention needed",
      "pattern_keywords": [
        "derivation",
        "comment",
        "parser",
        "test",
        "subagent",
        "M079"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "correct_behavior": "When spawning subagent for parser tests, include: STYLE: Do NOT add comments that describe expected node positions. Text blocks are self-documenting.",
      "recurrence_of": "M079"
    },
    {
      "id": "M081",
      "timestamp": "2026-01-14T05:45:00Z",
      "category": "protocol_violation",
      "description": "Used merge commit instead of linear rebase when main had diverged from task branch",
      "root_cause": "When --ff-only failed due to diverged branches, merged main INTO task branch creating non-linear history instead of using git-rebase skill",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/.claude/cat/workflows/execute-task.md",
      "pattern_keywords": [
        "merge",
        "rebase",
        "linear-history",
        "ff-only",
        "diverged"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "correct_behavior": "When --ff-only fails because main has diverged: (1) Use /cat:git-rebase to rebase task branch onto main, (2) Then merge with --ff-only to maintain linear history",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      }
    },
    {
      "id": "M082",
      "timestamp": "2026-01-14T06:00:00Z",
      "category": "protocol_violation",
      "pattern_id": null,
      "description": "Checked for task locks in wrong directory (/tmp/cat-locks/) instead of project-local .claude/cat/locks/",
      "root_cause": "Assumed lock path without verifying script source. CLAUDE_PROJECT_DIR/.claude/cat/locks is correct path.",
      "prevention_type": "documentation",
      "prevention_path": "/workspace/cat/skills/spawn-subagent/SKILL.md",
      "pattern_keywords": [
        "lock",
        "directory",
        "path",
        "verification",
        "environment"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "After lock acquire, verify by reading actual file at .claude/cat/locks/{task-id}.lock. Check session_id matches current session.",
      "processed_in_retrospective": null
    },
    {
      "id": "M083",
      "timestamp": "2026-01-14T06:20:00Z",
      "category": "protocol_violation",
      "pattern_id": null,
      "description": "Claimed lock file did not exist based on stale ls output from before session restart",
      "root_cause": "Failed to re-verify environment state after session restart. Relied on cached observation instead of fresh check.",
      "prevention_type": "documentation",
      "prevention_path": "/workspace/cat/skills/spawn-subagent/SKILL.md",
      "pattern_keywords": [
        "lock",
        "verification",
        "session",
        "restart",
        "stale",
        "environment"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "After session restart, re-run all environment verification commands (ls, cat, git status) before making claims about filesystem state.",
      "processed_in_retrospective": null
    },
    {
      "id": "M084",
      "timestamp": "2026-01-14T16:24:42Z",
      "category": "protocol_violation",
      "pattern_id": null,
      "description": "Attempted to force-release task lock instead of moving to next available task as required by protocol",
      "root_cause": "Completion bias overrode explicit MANDATORY instruction. Rationalized ignoring protocol by assuming lock was stale without evidence.",
      "prevention_type": "code_fix",
      "prevention_path": "/workspace/cat/scripts/task-lock.sh",
      "pattern_keywords": [
        "lock",
        "protocol",
        "mandatory",
        "completion_bias",
        "assumption"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "context_related": false,
      "tokens_at_error": 15000,
      "compaction_events": 0,
      "correct_behavior": "When lock acquisition fails, IMMEDIATELY search for another executable task. Do NOT investigate, question, or attempt to remove the lock. The lock exists therefore it is valid.",
      "escalated_from": "documentation",
      "escalation_reason": "Documentation already existed (execute-task.md says MANDATORY) but was ignored. Escalated to code fix that embeds guidance directly in lock output."
    },
    {
      "id": "M085",
      "timestamp": "2026-01-14T16:55:48Z",
      "category": "prompt_engineering",
      "pattern_id": null,
      "description": "Implementation commit did not include STATE.md update (M076 violation)",
      "root_cause": "Subagent prompt lacked STATE.md instruction. Main agent did not verify STATE.md in commit before approval gate.",
      "prevention_type": "validation",
      "prevention_path": "/workspace/cat/commands/execute-task.md",
      "pattern_keywords": [
        "STATE.md",
        "commit",
        "M076",
        "approval_gate"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "context_related": false,
      "escalated_from": "documentation",
      "escalation_reason": "spawn-subagent skill already had checklist item but was ignored. Added verification step.",
      "correct_behavior": "Include STATE.md update in subagent prompt AND verify in commit before approval gate."
    },
    {
      "id": "M086",
      "timestamp": "2026-01-15T05:40:00Z",
      "category": "prompt_engineering",
      "description": "Parser tests only verified parsing success, not AST correctness - violated isEqualTo requirement",
      "root_cause": "Subagent prompts did not include project-specific testing standards requiring AST comparison",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/CLAUDE.md",
      "pattern_keywords": [
        "parser",
        "test",
        "isEqualTo",
        "AST",
        "subagent",
        "prompt"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Include parser testing standards in subagent prompts: tests MUST use isEqualTo(expected) to compare actual AST to expected AST"
    },
    {
      "id": "M087",
      "timestamp": "2026-01-15T07:45:00Z",
      "category": "logical_error",
      "description": "Time estimate breakdown totaled ~18 min but actual execution was 25 min",
      "root_cause": "No guidance for accurate time estimation in agent workflows - estimated work time not wall clock time",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/.claude/cat/workflows/execute-task.md",
      "pattern_keywords": [
        "time_estimation",
        "wall_clock",
        "subagent_latency"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Include duplicate detection in exploration subagent to avoid spawning unnecessary planning/implementation subagents for pre-existing functionality"
    },
    {
      "id": "M088",
      "timestamp": "2026-01-15T12:00:00Z",
      "category": "protocol_violation",
      "description": "Main agent directly edited Parser.java (variable renaming) and java-style.md instead of delegating to subagent",
      "root_cause": "Completion bias - perceived variable renaming as too simple to warrant subagent delegation",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/cat/commands/execute-task.md",
      "pattern_keywords": [
        "main-agent",
        "edit-tool",
        "delegation",
        "completion-bias",
        "simple-changes"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": "M063",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "medium",
        "catches_variations": true
      },
      "correct_behavior": "When user provides feedback requiring any code changes (even simple renaming), spawn a subagent to implement the changes."
    },
    {
      "id": "M089",
      "timestamp": "2026-01-15T12:00:00Z",
      "category": "worktree_violation",
      "description": "Main agent edited STATE.md from main workspace instead of task worktree, causing merge conflict",
      "root_cause": "After creating task worktree, agent did not cd to it before editing STATE.md - compliance failure with documented MANDATORY step",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/cat/workflows/execute-task.md",
      "pattern_keywords": [
        "worktree",
        "cd",
        "STATE.md",
        "merge_conflict",
        "working_directory"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "After creating worktree, immediately cd to it and verify with pwd before any file operations"
    },
    {
      "id": "M090",
      "timestamp": "2026-01-15T22:16:28Z",
      "category": "assumption_without_verification",
      "description": "Used invalid commit type fix: instead of bugfix:",
      "root_cause": "Assumed conventional commits standard applies without checking project-specific commit-types.md",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/validate-commit-type.sh",
      "pattern_keywords": [
        "commit",
        "conventional-commits",
        "commit-type"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "negative",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Check commit-types.md before committing. Use bugfix: not fix:, feature: not feat:, performance: not perf:"
    },
    {
      "id": "M090",
      "timestamp": "2026-01-15T21:45:00Z",
      "category": "protocol_violation",
      "description": "When user said \"Learn from mistakes: you should summarize...\", agent provided summary but did not invoke learn-from-mistakes skill",
      "root_cause": "Documentation existed for trigger phrase recognition (M072) but agent did not follow it - documentation alone insufficient",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/hooks/inject-session-instructions.sh",
      "pattern_keywords": [
        "learn-from-mistakes",
        "trigger-phrase",
        "skill-invocation",
        "protocol"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": "M072",
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When user says \"Learn from mistakes: [description]\", INVOKE the skill first, complete RCA, THEN fix the immediate problem"
    },
    {
      "id": "M091",
      "timestamp": "2026-01-15T22:00:00Z",
      "category": "protocol_violation",
      "description": "Commit a00d9aa contained both config changes (retrospectives files) and bugfix code - should be separate commits per commit-types.md",
      "root_cause": "When amending commit to include STATE.md, retrospectives files were inadvertently included because they had been modified in the worktree from earlier operations",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "process",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/cat/workflows/execute-task.md",
      "pattern_keywords": [
        "commit",
        "mixed-types",
        "retrospectives",
        "amend",
        "staging"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Before amending commits, verify only intended files are staged. Use git add with specific paths, not -A or broad patterns. Check git diff --staged before commit."
    },
    {
      "id": "M092",
      "timestamp": "2026-01-15T17:37:31-05:00",
      "category": "protocol_violation",
      "description": "Failed to cleanup subagent branch before presenting approval gate",
      "root_cause": "Skipped execute-task step 11 (cleanup) and went directly to step 13 (approval). Documentation existed but compliance was not enforced.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "validation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/validate-pre-approval.sh",
      "pattern_keywords": [
        "subagent",
        "cleanup",
        "approval",
        "branch",
        "worktree"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "After merging subagent branch to task branch, cleanup worktree and branch BEFORE presenting approval gate to user"
    },
    {
      "id": "M093",
      "timestamp": "2026-01-15T23:04:47Z",
      "category": "protocol_violation",
      "description": "Ran 6+ additional bash commands to investigate task status instead of rendering from status-data.sh output",
      "root_cause": "Completion bias - prioritized 'better' output over following explicit skill workflow",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/commands/status.md",
      "pattern_keywords": [
        "status",
        "workflow",
        "bash",
        "script",
        "completion-bias"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use ONLY data from status-data.sh and gate collection; report script bugs after rendering",
      "pattern_id": "PATTERN-008"
    },
    {
      "id": "M094",
      "timestamp": "2026-01-16T10:00:00Z",
      "category": "prompt_engineering",
      "description": "Task size underestimation - PLAN.md estimated ~800 lines but exploration found ~2470 lines (48 methods)",
      "root_cause": "PLAN.md estimate not verified against actual codebase exploration. Token estimate of 26K based on inaccurate scope led to subagent exhausting context.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/skills/spawn-subagent/SKILL.md",
      "pattern_keywords": [
        "underestimation",
        "token",
        "scope",
        "exploration"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "After exploration reveals actual scope differs from PLAN.md estimate, update token estimate before spawning subagent"
    },
    {
      "id": "M095",
      "timestamp": "2026-01-16T10:30:00Z",
      "category": "logical_error",
      "description": "Created sequential dependencies for extraction tasks that could run in parallel - confused runtime method calls with task execution order",
      "root_cause": "Mistakenly assumed that because extracted methods call each other at runtime, the extraction tasks must run sequentially. Runtime dependencies are irrelevant for code extraction - only file section conflicts matter.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/skills/decompose-task/SKILL.md",
      "pattern_keywords": [
        "parallel",
        "dependencies",
        "extraction",
        "runtime",
        "decomposition"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "For code extraction tasks, ask whether tasks write to the same file section, not whether extracted methods call each other"
    },
    {
      "id": "M096",
      "timestamp": "2026-01-16T02:35:00Z",
      "category": "protocol_violation",
      "pattern_id": "PATTERN-013",
      "description": "Deleted lock files without user permission by assuming different session IDs meant stale locks",
      "root_cause": "Completion bias overrode documented protocol. Used direct filesystem access (rm, cat, ls) instead of task-lock.sh script, bypassing built-in safety guidance.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PLUGIN_ROOT}/hooks/block-lock-manipulation.sh",
      "pattern_keywords": [
        "lock",
        "delete",
        "rm",
        "stale",
        "session",
        "bypass"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "When encountering a lock owned by a different session: 1) Report the lock exists, 2) Move to execute a different task, 3) Only suggest user run /cat:cleanup if they believe the lock is stale. NEVER delete locks directly."
    },
    {
      "id": "M097",
      "timestamp": "2026-01-16T12:15:00Z",
      "category": "assumption_without_verification",
      "description": "Assumed locks with 0 commits in worktrees were stale and offered to remove them",
      "root_cause": "Assumed correlation between worktree commit count and lock staleness without evidence. Locks may be held by active sessions that haven't committed yet.",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/CLAUDE.md",
      "pattern_keywords": [
        "lock",
        "stale",
        "worktree",
        "commit-count",
        "assumption"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Report lock exists, find another task, inform user they can run /cat:cleanup if THEY believe it is stale. Never investigate, label, or offer to remove locks.",
      "pattern_id": "PATTERN-013"
    },
    {
      "id": "M098",
      "timestamp": "2026-01-16T14:30:00Z",
      "category": "logical_error",
      "description": "Token estimate underestimated implementation phase by 29% (66,000 estimated vs 85,100 actual)",
      "root_cause": "Estimation factors in execute-task.md underweight implementation subagent token usage by ~4x. Formula predicted 21,000 for implementation phase but actual was 85,100.",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "config",
      "prevention_path": "${CLAUDE_PLUGIN_ROOT}/.claude/cat/workflows/execute-task.md",
      "pattern_keywords": [
        "token_estimation",
        "implementation_subagent",
        "factor_calibration"
      ],
      "prevention_implemented": false,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Multiply implementation phase factors by 4x: files_to_create 20000, files_to_modify 12000, plan_steps 8000. Or add base implementation overhead of 50,000 tokens.",
      "notes": "CAT plugin source needs update. Implementation subagent has significant overhead beyond code generation including context loading, verification commands, and git operations."
    },
    {
      "id": "M099",
      "timestamp": "2026-01-16T15:00:00Z",
      "category": "protocol_violation",
      "description": "Main agent fabricated token estimates instead of having subagent measure and return actual usage",
      "root_cause": "execute-task workflow says 'report metrics' but doesn't mandate measurement. spawn-subagent and collect-results skills exist but weren't used.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/.claude/cat/workflows/execute-task.md, /workspace/cat/skills/spawn-subagent/SKILL.md",
      "pattern_keywords": [
        "token_measurement",
        "subagent",
        "fabrication",
        "estimation"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Subagent measures own tokens from session JSONL before completion. Main agent reports ONLY measured values from subagent output, never fabricates.",
      "pattern_id": "PATTERN-014"
    },
    {
      "id": "M100",
      "timestamp": "2026-01-16T03:31:38Z",
      "category": "detection_gap",
      "description": "PostToolUse hook falsely flagged jq stderr parse error text as requiring investigation when task completed successfully",
      "root_cause": "Hook pattern matched benign stderr output from jq commands checking already-locked tasks - no actual failure occurred",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "hook",
      "prevention_path": "/workspace/cat/hooks/auto-learn-from-mistakes.sh",
      "pattern_keywords": [
        "parse_error",
        "false_positive",
        "hook",
        "jq"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Parse error patterns now check exit code before triggering. Only flag parse errors when the command actually failed (non-zero exit code)."
    },
    {
      "id": "M101",
      "timestamp": "2026-01-16T14:30:00Z",
      "category": "protocol_violation",
      "description": "Main agent edited files in /workspace main worktree instead of task worktree during binary operators extraction",
      "root_cause": "No enforcement preventing edits to main worktree during CAT task execution; lost track of location after merge conflict resolution",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/.claude/cat/workflows/execute-task.md",
      "pattern_keywords": [
        "worktree",
        "main",
        "isolation",
        "merge_conflict"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Verify worktree location with pwd before any edits during CAT task; all implementation work happens in /workspace/.worktrees/<task-name>",
      "pattern_id": "PATTERN-008"
    },
    {
      "id": "M098",
      "timestamp": "2026-01-16T02:25:17-05:00",
      "category": "detection_gap",
      "description": "Used invalid commit type ui: which was not in valid types list",
      "root_cause": "Commit type validation hook used negative verification (blocking known-bad types) instead of positive verification (requiring known-good types)",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/validate-commit-type.sh",
      "pattern_keywords": [
        "commit-type",
        "positive-verification",
        "validation-gap"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use only valid commit types: feature, bugfix, test, refactor, performance, docs, style, config, planning"
    },
    {
      "id": "M102",
      "timestamp": "2026-01-16T10:01:00Z",
      "category": "prompt_engineering",
      "description": "Subagent failed to measure tokens - used ${SESSION_ID} which does not exist in subagent context",
      "root_cause": "Subagent prompt template used ${CLAUDE_SESSION_ID} assuming environment variable inheritance, but Task tool spawns fresh process without parent variables",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "documentation",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/CLAUDE.md",
      "pattern_keywords": [
        "token_measurement",
        "subagent",
        "session_id",
        "environment_variable"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Subagents find their own session file by looking for the most recently modified .jsonl file in the sessions directory, rather than relying on inherited environment variables",
      "pattern_id": "PATTERN-014"
    },
    {
      "id": "M103",
      "timestamp": "2026-01-16T10:15:00Z",
      "category": "documentation_violation",
      "description": "Put bold markdown inside code fence in status display (renders literally, not bold)",
      "root_cause": "Documentation contradiction - instructions say put bold outside code fences, but example template showed bold inside code fence",
      "rca_method": "B",
      "rca_method_name": "taxonomy",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/commands/status.md",
      "pattern_keywords": [
        "markdown",
        "code-fence",
        "bold",
        "rendering"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Put bold markers (**text**) outside code fences; remove decorative bold from ASCII boxes"
    },
    {
      "id": "M104",
      "timestamp": "2026-01-16T10:30:00Z",
      "category": "assumption_without_verification",
      "description": "Assumed mistakes.json was flat array, but it is object with .mistakes key - jq query failed",
      "root_cause": "Skill documentation internally inconsistent - some jq examples assumed flat array, others correctly used .mistakes[]",
      "rca_method": "C",
      "rca_method_name": "causal-barrier",
      "prevention_type": "skill",
      "prevention_path": "/workspace/cat/skills/learn-from-mistakes/SKILL.md",
      "pattern_keywords": [
        "jq",
        "json-structure",
        "array",
        "object"
      ],
      "prevention_implemented": true,
      "prevention_verified": true,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Check actual file structure before writing jq queries; skill now documents that mistakes.json is object with .mistakes array"
    },
    {
      "id": "M105",
      "timestamp": "2026-01-16T10:58:00Z",
      "category": "bash_error",
      "description": "Used status as variable name in bash loop - zsh read-only variable causes failure",
      "root_cause": "Reliance on memory instead of documentation, with no enforcement mechanism. CLAUDE.md documents this rule but was not referenced before writing command.",
      "rca_method": "A",
      "rca_method_name": "5-whys",
      "prevention_type": "hook",
      "prevention_path": "${CLAUDE_PROJECT_DIR}/.claude/hooks/warn-zsh-reserved-vars.sh",
      "pattern_keywords": [
        "zsh",
        "status",
        "reserved-variable",
        "bash",
        "read-only"
      ],
      "prevention_implemented": true,
      "prevention_verified": false,
      "recurrence_of": null,
      "prevention_quality": {
        "verification_type": "positive",
        "fragility": "low",
        "catches_variations": true
      },
      "correct_behavior": "Use alternative variable names: st, result, task_status, exit_code instead of status"
    }
  ],
  "mistake_count_since_last": 6
}
